<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<title>Cat clicker 0.4</title>
	<script>
			var model = {
				cats: [
					{
						"imgUrl" : "cat1.jpg",
						"catName" : "Fred",
						"clickCount" : 0
					},
					{
						"imgUrl" : "cat2.jpg",
						"catName" : "Ethel",
						"clickCount" : 0
					},
					{
						"imgUrl" : "cat3.jpg",
						"catName" : "Ricky",
						"clickCount" : 0
					},
					{
						"imgUrl" : "cat4.jpg",
						"catName" : "Lucy",
						"clickCount" : 0
					},
					{
						"imgUrl" : "cat5.jpg",
						"catName" : "Groucho",
						"clickCount" : 0
					},
				],

				init: function() {
					currentCat = 0;
				}
			};

			var octopus = {
				init: function() {
					model.init();
					catListArray = model.cats;
					$(document).ready(function(cat) {
						$("#catContainer").click(function(){
							octopus.clickUp(cat);
						});
					});
					viewCatList.render();
				},
				getCat: function(cat) {
					catImgUrl = model.cats[cat].imgUrl;
					catName = model.cats[cat].catName;
					catCount = model.cats[cat].clickCount;
					currentCat = cat;
				},
				clickUp: function() {
					model.cats[currentCat].clickCount++;
					$("#number").text(model.cats[currentCat].clickCount);
				}
			};

			var viewCat = {
				render: function(cat) {
					octopus.getCat(cat);
					$("#catContainer").empty();
					var catBuilder = "<div class='cat'><div class='name'>%name%</div><div class='number' id='number'>" + catCount + "</div><div class='catImg'><img class='catImg' id='clickable%name%' src='img/%imgUrl%'></div></div>";
					var builtCat = catBuilder.replace(/%imgUrl%/g, catImgUrl);
					namedCat = builtCat.replace(/%name%/g, catName);
					$("#catContainer").append(namedCat);
				}
			};

// TODO: catList render method


			var viewCatList = {
				render: function() {
					var listBuilder = "<li><a href='#' id='%name%'>%name%</a></li>";
					$(document).ready(function() {
						for (i in catListArray) {
							var catListName = catListArray[i].catName;
							var catListId = "#" + catListName;
							var catListNumber = i;
							var builtListItem = listBuilder.replace(/%name%/g, catListName);
							$("#catList").append(builtListItem);
							// store the cat ID number in an IIFE, build the new click listener
							$(catListId).click(function(catListNumberCopy){
								return function() {
									// if the selected cat is already displayed, do nothing
									if (catListNumberCopy == currentCat) {
									return;
									};
									// display the selected cat
									currentCat = catListNumberCopy
									viewCat.render(currentCat);
									}
								}(catListNumber));
						}
					});
				}
			};


			octopus.init();
	</script>
</head>
<body>
	<div class="container">
		<div class="listBox">
			<ul id="catList">
			</ul>
		</div>
		<div class="catContainer" id="catContainer">

		</div>
	</div>
</body>
</html>